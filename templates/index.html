{% extends 'base.html' %}
{% block content %}
<h2 class="my-4">Component List</h2>
<table class="table table-striped table-bordered" id="myTable">
    <thead class="thead-dark">
        <tr>
            <th>Name</th>
            <th>Category</th>
            <th>Quantity</th>
            <th>Location</th>
            <th>Out</th>
            <th>Total</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for component in components %}
        <tr>
            <td>{{ component.name }}</td>
            <td>{{ component.category }}</td>
            <td>{{ component.quantity }}</td>
            <td>{{ component.location }}</td>
            <td>{{ component.out }}</td>
            <td>{{ component.quantity - component.out }}</td>
            <td>
                <a href="{{ url_for('update', id=component.id) }}" class="btn btn-warning btn-sm">Update</a>
                <a href="{{ url_for('delete', id=component.id) }}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')">Delete</a>
                <a href="{{ url_for('borrow', component_id=component.id) }}" class="btn btn-info btn-sm">Borrow</a>

            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h2 class="my-4">Borrowed Components</h2>
<table class="table table-striped table-bordered" id="myTable2">
    <thead class="thead-dark">
        <tr>
            <th>Borrower</th>
            <th>Component</th>
            <th>Quantity</th>
            <th>Borrowed Date</th>
            <th>Returned Date</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for borrowed in borrowed_components %}
        <tr>
            <td>{{ borrowed.borrower_name }}</td>
            <td>{{ borrowed.component.name }}</td>
            <td>{{ borrowed.borrowed_quantity }}</td>
            <td>{{ borrowed.borrowed_date.strftime('%d %b, %Y %H:%M:%S') }}</td>
            <td>
                {% if borrowed.returned_date %}
                    {{ borrowed.returned_date.strftime('%d %b, %Y %H:%M:%S') }}
                {% else %}
                    Not Returned
                {% endif %}
            </td>                
            <td>
                {% if not borrowed.returned_date %}
                <a href="{{ url_for('return_component', borrowed_id=borrowed.id) }}" class="btn btn-success btn-sm">Return</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
